# Удаление всех null !heading

### Команда BOOM

#### Постановка задачи
Требуется исключить в AST-дереве null-операторы.

#### Зависимости задач в графе задач
Задача зависит от:
* генерация AST-дерева;
* заполнение связей типа "предок-потомок".

#### Теория
В исходном коде программы зачастую можно встретить null-операторы. Они не несут какой-либо полезной информации, следовательно от них нужно избавиться. На этапе компиляции можно выявить такие места и произвести оптимизацию.

#### Особенности реализации
При использовании программного кода, позволяющего произвести оптимизацию устранения null-операторов, требуется произвести построение AST-дерева для исходного кода программы, написанном на реализованном языке программирования, и выделить для построенного дерева связи типа "предок-потомок". К полученному дереву следует применить визитор SimpleLang.Visitors.DeleteNullVisitor. Таким образом, последовательность действий для использования данной оптимизации будет следующей:
1) сгенерировать AST-дерево;
2) с помощью визитора SimpleLang.Visitors.FillParentVisitor заполнить связи между узлами дерева типа "предок-потомок";
3) создать объект типа SimpleLang.Visitors.DeleteNullVisitor;
4) для полученного дерева вызвать функцию Visit с объектом DeleteNullVisitor, созданном на 3-ем этапе, поданным как аргумент функции.

Для решения этой задачи был реализован класс DeleteNullVisitor, который переопределяет процедуры  VisitBlockNode и VisitIfNode.
```csharp
class DeleteNullVisitor: ChangeVisitor
   {
       public override void VisitBlockNode(BlockNode bln)
       {
           bln.StList = bln.StList.Where(x =>!(x is NullNode)).ToList();
       }
       public override void VisitIfNode(IfNode ifn)
       {
           if (ifn.Else is NullNode)
           {
               ReplaceStat(ifn, new NullNode());
           }
       }
   }
```


#### Тесты
Из исходной программы вида
```csharp
{
    int a, b, c;
    a = 3;
    #NULL;
    b = 2;
    #NULL;
    c = 1;
    #NULL;
    c = c + a;
}

```

Мы получаем
```csharp
{
    int a, b, c;
    a = 3;
    b = 2;
    c = 1;
    c = c + a;
}

```

[Вверх](#содержание)
